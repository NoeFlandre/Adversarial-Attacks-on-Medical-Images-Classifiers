2025-03-25 14:03:37,209 - INFO - Logging initialized. Log file: /Users/noeflandre/Documents/[03] School/École d'ingénieur/3A/IIT Bombay/Courses/Medical Image Computing/Project/Adversarial-Attacks-on-Medical-Images-Classifiers/models/logistic_classifier/logs/logistic_classifier_20250325_140337.log
2025-03-25 14:03:37,209 - INFO - Starting Logistic Regression classifier training and evaluation
2025-03-25 14:03:37,209 - INFO - Configuration:
2025-03-25 14:03:37,209 - INFO -   - Epochs: 10
2025-03-25 14:03:37,209 - INFO -   - Batch size: 1024
2025-03-25 14:03:37,209 - INFO -   - Learning rate: 1e-05
2025-03-25 14:03:37,209 - INFO -   - Weight decay: 1e-05
2025-03-25 14:03:37,209 - INFO -   - Validation ratio: 0.2
2025-03-25 14:03:37,209 - INFO - 
Loading datasets from data/
2025-03-25 14:03:39,215 - INFO - Training set size: 222019
2025-03-25 14:03:39,215 - INFO - Validation set size: 55505
2025-03-25 14:03:39,215 - INFO - 
Initializing Logistic Regression model
2025-03-25 14:03:39,334 - INFO - Using device: mps
2025-03-25 14:03:39,334 - INFO - 
Starting model training
2025-03-25 14:05:05,703 - INFO - Training with batch size: 1024, initial learning rate: 1e-05, epochs: 10
2025-03-25 14:05:05,706 - INFO - Class weights: [0.6980544328689575, 1.7622793912887573]
2025-03-25 14:06:43,161 - INFO - [Epoch 1/10] Train Loss: 0.5996, Val Loss: 0.5260, Val Accuracy: 0.7699
2025-03-25 14:08:12,201 - INFO - [Epoch 2/10] Train Loss: 0.5188, Val Loss: 0.5154, Val Accuracy: 0.7729
2025-03-25 14:09:39,765 - INFO - Reducing learning rate to 8.00e-06
2025-03-25 14:09:39,766 - INFO - [Epoch 3/10] Train Loss: 0.5116, Val Loss: 0.5108, Val Accuracy: 0.7754
2025-03-25 14:11:12,084 - INFO - Reducing learning rate to 6.40e-06
2025-03-25 14:11:12,085 - INFO - [Epoch 4/10] Train Loss: 0.5079, Val Loss: 0.5084, Val Accuracy: 0.7761
2025-03-25 14:12:41,998 - INFO - Reducing learning rate to 5.12e-06
2025-03-25 14:12:41,999 - INFO - [Epoch 5/10] Train Loss: 0.5059, Val Loss: 0.5071, Val Accuracy: 0.7769
2025-03-25 14:14:20,443 - INFO - Reducing learning rate to 4.10e-06
2025-03-25 14:14:20,445 - INFO - [Epoch 6/10] Train Loss: 0.5045, Val Loss: 0.5061, Val Accuracy: 0.7773
2025-03-25 14:15:50,432 - INFO - Reducing learning rate to 3.28e-06
2025-03-25 14:15:50,434 - INFO - [Epoch 7/10] Train Loss: 0.5036, Val Loss: 0.5055, Val Accuracy: 0.7781
2025-03-25 14:17:27,920 - INFO - Reducing learning rate to 2.62e-06
2025-03-25 14:17:27,920 - INFO - [Epoch 8/10] Train Loss: 0.5029, Val Loss: 0.5049, Val Accuracy: 0.7783
2025-03-25 14:18:59,966 - INFO - Reducing learning rate to 2.10e-06
2025-03-25 14:18:59,967 - INFO - [Epoch 9/10] Train Loss: 0.5023, Val Loss: 0.5047, Val Accuracy: 0.7784
2025-03-25 14:20:31,666 - INFO - Reducing learning rate to 1.68e-06
2025-03-25 14:20:31,666 - INFO - [Epoch 10/10] Train Loss: 0.5020, Val Loss: 0.5043, Val Accuracy: 0.7791
2025-03-25 14:20:32,024 - INFO - Saved training and validation loss plot to /Users/noeflandre/Documents/[03] School/École d'ingénieur/3A/IIT Bombay/Courses/Medical Image Computing/Project/Adversarial-Attacks-on-Medical-Images-Classifiers/models/logistic_classifier/results/training_validation_loss.png
2025-03-25 14:20:32,025 - INFO - 
Starting model evaluation on validation set
2025-03-25 14:20:32,025 - INFO - Evaluating model with batch size: 1024
2025-03-25 14:20:56,431 - INFO - Evaluation results:
2025-03-25 14:20:56,432 - INFO -   - Accuracy: 0.7791
2025-03-25 14:20:56,432 - INFO -   - Balanced Accuracy: 0.7813
2025-03-25 14:20:56,432 - INFO -   - Precision: 0.5828
2025-03-25 14:20:56,432 - INFO -   - Recall: 0.7864
2025-03-25 14:20:56,432 - INFO -   - Specificity: 0.7761
2025-03-25 14:20:56,432 - INFO -   - F1 Score: 0.6695
2025-03-25 14:20:56,432 - INFO -   - AUC: 0.8503
2025-03-25 14:20:56,432 - INFO -   - Confusion Matrix: 
[[30821  8890]
 [ 3373 12421]]
2025-03-25 14:20:56,433 - INFO - Saved metrics to /Users/noeflandre/Documents/[03] School/École d'ingénieur/3A/IIT Bombay/Courses/Medical Image Computing/Project/Adversarial-Attacks-on-Medical-Images-Classifiers/models/logistic_classifier/results/metrics_20250325_142056.json
2025-03-25 14:20:56,498 - INFO - Saved confusion matrix plot to /Users/noeflandre/Documents/[03] School/École d'ingénieur/3A/IIT Bombay/Courses/Medical Image Computing/Project/Adversarial-Attacks-on-Medical-Images-Classifiers/models/logistic_classifier/results/confusion_matrix_20250325_142056.png
2025-03-25 14:20:56,536 - INFO - Saved ROC curve plot to /Users/noeflandre/Documents/[03] School/École d'ingénieur/3A/IIT Bombay/Courses/Medical Image Computing/Project/Adversarial-Attacks-on-Medical-Images-Classifiers/models/logistic_classifier/results/roc_curve_20250325_142056.png
2025-03-25 14:20:56,540 - INFO - Model and metrics saved to /Users/noeflandre/Documents/[03] School/École d'ingénieur/3A/IIT Bombay/Courses/Medical Image Computing/Project/Adversarial-Attacks-on-Medical-Images-Classifiers/models/logistic_classifier/checkpoints/logistic_regression_model_20250325_142056.pth
2025-03-25 14:20:56,541 - INFO - 
Completed training and evaluation
