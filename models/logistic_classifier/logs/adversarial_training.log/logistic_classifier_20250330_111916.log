2025-03-30 11:19:16,809 - INFO - Logging initialized. Log file: /Users/noeflandre/Documents/[03] School/École d'ingénieur/3A/IIT Bombay/Courses/Medical Image Computing/Project/Adversarial-Attacks-on-Medical-Images-Classifiers/models/logistic_classifier/logs/adversarial_training.log/logistic_classifier_20250330_111916.log
2025-03-30 11:19:16,809 - INFO - Starting Logistic Regression classifier with adversarial training
2025-03-30 11:19:16,809 - INFO - Configuration:
2025-03-30 11:19:16,809 - INFO -   - Epochs: 10
2025-03-30 11:19:16,810 - INFO -   - Batch size: 1024
2025-03-30 11:19:16,810 - INFO -   - Learning rate: 1e-05
2025-03-30 11:19:16,810 - INFO -   - Weight decay: 1e-05
2025-03-30 11:19:16,810 - INFO -   - Validation ratio: 0.2
2025-03-30 11:19:16,810 - INFO -   - FGSM epsilon: 0.05
2025-03-30 11:19:16,810 - INFO -   - Mix ratio: 0.5
2025-03-30 11:19:16,810 - INFO - 
Loading datasets from data/
2025-03-30 11:19:18,679 - INFO - Training set size: 222019
2025-03-30 11:19:18,679 - INFO - Validation set size: 55505
2025-03-30 11:19:18,679 - INFO - 
Initializing Logistic Regression model
2025-03-30 11:19:18,699 - INFO - Using device: mps
2025-03-30 11:19:18,699 - INFO - 
Starting model training with adversarial examples
2025-03-30 11:20:39,014 - INFO - Training with adversarial examples (FGSM, epsilon=0.05, mix_ratio=0.5)
2025-03-30 11:20:39,015 - INFO - Batch size: 1024, initial learning rate: 1e-05, epochs: 10
2025-03-30 11:20:39,015 - INFO - Class weights: [0.6980544328689575, 1.7622793912887573]
2025-03-30 11:22:17,630 - INFO - [Epoch 1/10] Train Loss: 3.3796, Clean Val Acc: 0.7463, Adv Val Acc: 0.0007
2025-03-30 11:23:54,346 - INFO - [Epoch 2/10] Train Loss: 4.1725, Clean Val Acc: 0.7559, Adv Val Acc: 0.0215
2025-03-30 11:25:31,205 - INFO - [Epoch 3/10] Train Loss: 1.8804, Clean Val Acc: 0.7599, Adv Val Acc: 0.0680
2025-03-30 11:27:08,640 - INFO - [Epoch 4/10] Train Loss: 0.9978, Clean Val Acc: 0.7622, Adv Val Acc: 0.2688
2025-03-30 11:28:45,568 - INFO - Reducing learning rate to 8.00e-06
2025-03-30 11:28:45,569 - INFO - [Epoch 5/10] Train Loss: 0.7240, Clean Val Acc: 0.7624, Adv Val Acc: 0.5133
2025-03-30 11:30:25,867 - INFO - Reducing learning rate to 6.40e-06
2025-03-30 11:30:25,868 - INFO - [Epoch 6/10] Train Loss: 0.6525, Clean Val Acc: 0.7651, Adv Val Acc: 0.5609
2025-03-30 11:32:03,176 - INFO - Reducing learning rate to 5.12e-06
2025-03-30 11:32:03,176 - INFO - [Epoch 7/10] Train Loss: 0.6419, Clean Val Acc: 0.7681, Adv Val Acc: 0.5657
2025-03-30 11:33:43,644 - INFO - Reducing learning rate to 4.10e-06
2025-03-30 11:33:43,645 - INFO - [Epoch 8/10] Train Loss: 0.6407, Clean Val Acc: 0.7699, Adv Val Acc: 0.5675
2025-03-30 11:35:26,025 - INFO - Reducing learning rate to 3.28e-06
2025-03-30 11:35:26,027 - INFO - [Epoch 9/10] Train Loss: 0.6403, Clean Val Acc: 0.7711, Adv Val Acc: 0.5685
2025-03-30 11:37:08,176 - INFO - Reducing learning rate to 2.62e-06
2025-03-30 11:37:08,177 - INFO - [Epoch 10/10] Train Loss: 0.6397, Clean Val Acc: 0.7720, Adv Val Acc: 0.5692
2025-03-30 11:37:08,546 - INFO - Saved training plots to /Users/noeflandre/Documents/[03] School/École d'ingénieur/3A/IIT Bombay/Courses/Medical Image Computing/Project/Adversarial-Attacks-on-Medical-Images-Classifiers/models/logistic_classifier/results/adversarial_training/training_validation_loss_eps0.05_mix0.5_20250330_113708.png and /Users/noeflandre/Documents/[03] School/École d'ingénieur/3A/IIT Bombay/Courses/Medical Image Computing/Project/Adversarial-Attacks-on-Medical-Images-Classifiers/models/logistic_classifier/results/adversarial_training/clean_vs_adversarial_accuracy_eps0.05_mix0.5_20250330_113708.png
2025-03-30 11:37:08,546 - INFO - Saved training history to /Users/noeflandre/Documents/[03] School/École d'ingénieur/3A/IIT Bombay/Courses/Medical Image Computing/Project/Adversarial-Attacks-on-Medical-Images-Classifiers/models/logistic_classifier/results/adversarial_training/training_history_eps0.05_mix0.5_20250330_113708.json
2025-03-30 11:37:08,547 - INFO - 
Starting model evaluation on validation set
2025-03-30 11:37:08,547 - INFO - Evaluating model with batch size: 1024
2025-03-30 11:37:25,406 - INFO - Evaluation results:
2025-03-30 11:37:25,408 - INFO -   - Accuracy: 0.7720
2025-03-30 11:37:25,408 - INFO -   - Balanced Accuracy: 0.7743
2025-03-30 11:37:25,408 - INFO -   - Precision: 0.5731
2025-03-30 11:37:25,408 - INFO -   - Recall: 0.7795
2025-03-30 11:37:25,408 - INFO -   - Specificity: 0.7691
2025-03-30 11:37:25,408 - INFO -   - F1 Score: 0.6606
2025-03-30 11:37:25,408 - INFO -   - AUC: 0.8451
2025-03-30 11:37:25,408 - INFO -   - Confusion Matrix: 
[[30540  9171]
 [ 3482 12312]]
2025-03-30 11:37:25,408 - INFO - Saving results to adversarial training directory
2025-03-30 11:37:25,409 - INFO - Saved metrics to /Users/noeflandre/Documents/[03] School/École d'ingénieur/3A/IIT Bombay/Courses/Medical Image Computing/Project/Adversarial-Attacks-on-Medical-Images-Classifiers/models/logistic_classifier/results/adversarial_training/metrics_20250330_113725.json
2025-03-30 11:37:25,473 - INFO - Saved confusion matrix plot to /Users/noeflandre/Documents/[03] School/École d'ingénieur/3A/IIT Bombay/Courses/Medical Image Computing/Project/Adversarial-Attacks-on-Medical-Images-Classifiers/models/logistic_classifier/results/adversarial_training/confusion_matrix_20250330_113725.png
2025-03-30 11:37:25,511 - INFO - Saved ROC curve plot to /Users/noeflandre/Documents/[03] School/École d'ingénieur/3A/IIT Bombay/Courses/Medical Image Computing/Project/Adversarial-Attacks-on-Medical-Images-Classifiers/models/logistic_classifier/results/adversarial_training/roc_curve_20250330_113725.png
2025-03-30 11:37:25,516 - INFO - Model and metrics saved to /Users/noeflandre/Documents/[03] School/École d'ingénieur/3A/IIT Bombay/Courses/Medical Image Computing/Project/Adversarial-Attacks-on-Medical-Images-Classifiers/models/logistic_classifier/checkpoints/logistic_regression_adversarial_eps0.05_mix0.5_20250330_113725.pth
2025-03-30 11:37:25,516 - INFO - Results summary saved to /Users/noeflandre/Documents/[03] School/École d'ingénieur/3A/IIT Bombay/Courses/Medical Image Computing/Project/Adversarial-Attacks-on-Medical-Images-Classifiers/models/logistic_classifier/results/adversarial_training/adversarial_training_summary_eps0.05_mix0.5_20250330_113725.json
2025-03-30 11:37:25,516 - INFO - 
Completed adversarial training and evaluation
