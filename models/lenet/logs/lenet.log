2025-03-24 17:44:48,618 - lenet - INFO - Starting LeNet training with parameters: Namespace(data_dir='data/', epochs=20, batch_size=1024, lr=0.0001, dropout_rate=0.5, val_ratio=0.2, seed=42, patience=5, eval_freq=1)
2025-03-24 17:44:50,947 - lenet - INFO - Starting model training...
2025-03-24 17:44:51,010 - lenet - INFO - Model has 289,850 trainable parameters
2025-03-24 17:46:09,614 - lenet - INFO - Training with batch size: 1024, initial learning rate: 0.0001, epochs: 20
2025-03-24 17:46:09,615 - lenet - INFO - Class weights: [0.6980544328689575, 1.7622793912887573]
2025-03-24 17:46:09,615 - lenet - INFO - Warmup epochs: 3
2025-03-24 17:47:44,794 - lenet - INFO - [Epoch 1/20]
  Training - Loss: 0.5354, Grad Norm: 0.6244
  Training - Accuracy: 0.7662, Precision: 0.5709
  Training - Recall: 0.7091, F1: 0.6325
  Learning Rate: 3.33e-05
  Validation - Loss: 0.4470
  Validation - Accuracy: 0.7941
  Validation - Balanced Accuracy: 0.8025
  Validation - Precision: 0.6011
  Validation - Recall: 0.8220
  Validation - Specificity: 0.7831
  Validation - F1: 0.6944
2025-03-24 17:49:12,570 - lenet - INFO - [Epoch 2/20]
  Training - Loss: 0.4548, Grad Norm: 0.5800
  Training - Accuracy: 0.8057, Precision: 0.6227
  Training - Recall: 0.7998, F1: 0.7002
  Learning Rate: 6.67e-05
  Validation - Loss: 0.4267
  Validation - Accuracy: 0.8164
  Validation - Balanced Accuracy: 0.8106
  Validation - Precision: 0.6431
  Validation - Recall: 0.7971
  Validation - Specificity: 0.8241
  Validation - F1: 0.7118
2025-03-24 17:50:38,447 - lenet - INFO - [Epoch 3/20]
  Training - Loss: 0.4319, Grad Norm: 0.6660
  Training - Accuracy: 0.8169, Precision: 0.6404
  Training - Recall: 0.8089, F1: 0.7149
  Learning Rate: 1.00e-04
  Validation - Loss: 0.4108
  Validation - Accuracy: 0.8120
  Validation - Balanced Accuracy: 0.8214
  Validation - Precision: 0.6260
  Validation - Recall: 0.8430
  Validation - Specificity: 0.7997
  Validation - F1: 0.7185
2025-03-24 17:52:02,627 - lenet - INFO - [Epoch 4/20]
  Training - Loss: 0.4083, Grad Norm: 0.8935
  Training - Accuracy: 0.8268, Precision: 0.6547
  Training - Recall: 0.8245, F1: 0.7298
  Learning Rate: 1.00e-04
  Validation - Loss: 0.3934
  Validation - Accuracy: 0.8047
  Validation - Balanced Accuracy: 0.8286
  Validation - Precision: 0.6078
  Validation - Recall: 0.8840
  Validation - Specificity: 0.7731
  Validation - F1: 0.7203
2025-03-24 17:53:28,824 - lenet - INFO - [Epoch 5/20]
  Training - Loss: 0.3938, Grad Norm: 0.9520
  Training - Accuracy: 0.8328, Precision: 0.6625
  Training - Recall: 0.8374, F1: 0.7398
  Learning Rate: 9.91e-05
  Validation - Loss: 0.3942
  Validation - Accuracy: 0.7927
  Validation - Balanced Accuracy: 0.8272
  Validation - Precision: 0.5880
  Validation - Recall: 0.9072
  Validation - Specificity: 0.7471
  Validation - F1: 0.7135
2025-03-24 17:55:00,994 - lenet - INFO - [Epoch 6/20]
  Training - Loss: 0.3851, Grad Norm: 0.9575
  Training - Accuracy: 0.8355, Precision: 0.6656
  Training - Recall: 0.8447, F1: 0.7445
  Learning Rate: 9.66e-05
  Validation - Loss: 0.3788
  Validation - Accuracy: 0.8133
  Validation - Balanced Accuracy: 0.8347
  Validation - Precision: 0.6206
  Validation - Recall: 0.8845
  Validation - Specificity: 0.7849
  Validation - F1: 0.7294
2025-03-24 17:56:31,241 - lenet - INFO - [Epoch 7/20]
  Training - Loss: 0.3802, Grad Norm: 0.9718
  Training - Accuracy: 0.8380, Precision: 0.6692
  Training - Recall: 0.8485, F1: 0.7483
  Learning Rate: 9.25e-05
  Validation - Loss: 0.3690
  Validation - Accuracy: 0.8492
  Validation - Balanced Accuracy: 0.8433
  Validation - Precision: 0.6976
  Validation - Recall: 0.8297
  Validation - Specificity: 0.8569
  Validation - F1: 0.7580
2025-03-24 17:58:03,442 - lenet - INFO - [Epoch 8/20]
  Training - Loss: 0.3750, Grad Norm: 0.9722
  Training - Accuracy: 0.8388, Precision: 0.6697
  Training - Recall: 0.8519, F1: 0.7499
  Learning Rate: 8.70e-05
  Validation - Loss: 0.3651
  Validation - Accuracy: 0.8256
  Validation - Balanced Accuracy: 0.8433
  Validation - Precision: 0.6401
  Validation - Recall: 0.8843
  Validation - Specificity: 0.8023
  Validation - F1: 0.7427
2025-03-24 17:59:35,349 - lenet - INFO - [Epoch 9/20]
  Training - Loss: 0.3713, Grad Norm: 0.9780
  Training - Accuracy: 0.8414, Precision: 0.6746
  Training - Recall: 0.8523, F1: 0.7531
  Learning Rate: 8.01e-05
  Validation - Loss: 0.3602
  Validation - Accuracy: 0.8405
  Validation - Balanced Accuracy: 0.8473
  Validation - Precision: 0.6708
  Validation - Recall: 0.8631
  Validation - Specificity: 0.8315
  Validation - F1: 0.7549
2025-03-24 18:01:08,188 - lenet - INFO - [Epoch 10/20]
  Training - Loss: 0.3693, Grad Norm: 0.9797
  Training - Accuracy: 0.8430, Precision: 0.6776
  Training - Recall: 0.8522, F1: 0.7550
  Learning Rate: 7.23e-05
  Validation - Loss: 0.3629
  Validation - Accuracy: 0.8487
  Validation - Balanced Accuracy: 0.8468
  Validation - Precision: 0.6926
  Validation - Recall: 0.8422
  Validation - Specificity: 0.8513
  Validation - F1: 0.7601
2025-03-24 18:02:39,252 - lenet - INFO - [Epoch 11/20]
  Training - Loss: 0.3668, Grad Norm: 0.9840
  Training - Accuracy: 0.8440, Precision: 0.6786
  Training - Recall: 0.8553, F1: 0.7568
  Learning Rate: 6.37e-05
  Validation - Loss: 0.3626
  Validation - Accuracy: 0.8249
  Validation - Balanced Accuracy: 0.8447
  Validation - Precision: 0.6377
  Validation - Recall: 0.8906
  Validation - Specificity: 0.7988
  Validation - F1: 0.7432
2025-03-24 18:04:08,040 - lenet - INFO - [Epoch 12/20]
  Training - Loss: 0.3636, Grad Norm: 0.9857
  Training - Accuracy: 0.8456, Precision: 0.6814
  Training - Recall: 0.8558, F1: 0.7587
  Learning Rate: 5.46e-05
  Validation - Loss: 0.3723
  Validation - Accuracy: 0.8607
  Validation - Balanced Accuracy: 0.8407
  Validation - Precision: 0.7367
  Validation - Recall: 0.7943
  Validation - Specificity: 0.8871
  Validation - F1: 0.7644
2025-03-24 18:05:40,356 - lenet - INFO - [Epoch 13/20]
  Training - Loss: 0.3616, Grad Norm: 0.9867
  Training - Accuracy: 0.8459, Precision: 0.6816
  Training - Recall: 0.8576, F1: 0.7595
  Learning Rate: 4.54e-05
  Validation - Loss: 0.3577
  Validation - Accuracy: 0.8543
  Validation - Balanced Accuracy: 0.8488
  Validation - Precision: 0.7061
  Validation - Recall: 0.8361
  Validation - Specificity: 0.8616
  Validation - F1: 0.7656
2025-03-24 18:07:14,824 - lenet - INFO - [Epoch 14/20]
  Training - Loss: 0.3593, Grad Norm: 0.9810
  Training - Accuracy: 0.8469, Precision: 0.6835
  Training - Recall: 0.8575, F1: 0.7607
  Learning Rate: 3.63e-05
  Validation - Loss: 0.3527
  Validation - Accuracy: 0.8479
  Validation - Balanced Accuracy: 0.8504
  Validation - Precision: 0.6867
  Validation - Recall: 0.8561
  Validation - Specificity: 0.8446
  Validation - F1: 0.7621
2025-03-24 18:08:44,620 - lenet - INFO - [Epoch 15/20]
  Training - Loss: 0.3592, Grad Norm: 0.9908
  Training - Accuracy: 0.8473, Precision: 0.6838
  Training - Recall: 0.8587, F1: 0.7614
  Learning Rate: 2.77e-05
  Validation - Loss: 0.3542
  Validation - Accuracy: 0.8521
  Validation - Balanced Accuracy: 0.8511
  Validation - Precision: 0.6972
  Validation - Recall: 0.8489
  Validation - Specificity: 0.8534
  Validation - F1: 0.7656
2025-03-24 18:10:20,135 - lenet - INFO - [Epoch 16/20]
  Training - Loss: 0.3573, Grad Norm: 0.9875
  Training - Accuracy: 0.8475, Precision: 0.6842
  Training - Recall: 0.8592, F1: 0.7618
  Learning Rate: 1.99e-05
  Validation - Loss: 0.3508
  Validation - Accuracy: 0.8422
  Validation - Balanced Accuracy: 0.8513
  Validation - Precision: 0.6714
  Validation - Recall: 0.8725
  Validation - Specificity: 0.8302
  Validation - F1: 0.7589
2025-03-24 18:11:53,055 - lenet - INFO - [Epoch 17/20]
  Training - Loss: 0.3561, Grad Norm: 0.9914
  Training - Accuracy: 0.8478, Precision: 0.6840
  Training - Recall: 0.8614, F1: 0.7625
  Learning Rate: 1.30e-05
  Validation - Loss: 0.3507
  Validation - Accuracy: 0.8494
  Validation - Balanced Accuracy: 0.8521
  Validation - Precision: 0.6888
  Validation - Recall: 0.8586
  Validation - Specificity: 0.8457
  Validation - F1: 0.7644
2025-03-24 18:13:25,589 - lenet - INFO - [Epoch 18/20]
  Training - Loss: 0.3552, Grad Norm: 0.9872
  Training - Accuracy: 0.8481, Precision: 0.6851
  Training - Recall: 0.8599, F1: 0.7626
  Learning Rate: 7.49e-06
  Validation - Loss: 0.3499
  Validation - Accuracy: 0.8468
  Validation - Balanced Accuracy: 0.8517
  Validation - Precision: 0.6826
  Validation - Recall: 0.8630
  Validation - Specificity: 0.8404
  Validation - F1: 0.7623
2025-03-24 18:14:59,092 - lenet - INFO - [Epoch 19/20]
  Training - Loss: 0.3549, Grad Norm: 0.9889
  Training - Accuracy: 0.8489, Precision: 0.6862
  Training - Recall: 0.8609, F1: 0.7637
  Learning Rate: 3.38e-06
  Validation - Loss: 0.3499
  Validation - Accuracy: 0.8487
  Validation - Balanced Accuracy: 0.8522
  Validation - Precision: 0.6870
  Validation - Recall: 0.8602
  Validation - Specificity: 0.8441
  Validation - F1: 0.7639
2025-03-24 18:16:29,401 - lenet - INFO - [Epoch 20/20]
  Training - Loss: 0.3542, Grad Norm: 0.9880
  Training - Accuracy: 0.8491, Precision: 0.6867
  Training - Recall: 0.8612, F1: 0.7641
  Learning Rate: 8.51e-07
  Validation - Loss: 0.3497
  Validation - Accuracy: 0.8469
  Validation - Balanced Accuracy: 0.8523
  Validation - Precision: 0.6822
  Validation - Recall: 0.8649
  Validation - Specificity: 0.8398
  Validation - F1: 0.7628
2025-03-24 18:16:29,412 - lenet - INFO - Restored best model from epoch 20
2025-03-24 18:16:30,014 - lenet - INFO - Saved training history and plots to /Users/noeflandre/Documents/[03] School/École d'ingénieur/3A/IIT Bombay/Courses/Medical Image Computing/Project/Adversarial-Attacks-on-Medical-Images-Classifiers/models/lenet/results
2025-03-24 18:16:30,018 - lenet - INFO - Evaluating model on validation set...
2025-03-24 18:16:30,020 - lenet - INFO - Evaluating model with batch size: 1024
2025-03-24 18:17:03,836 - lenet - INFO - Evaluation results:
2025-03-24 18:17:03,836 - lenet - INFO -   - Accuracy: 0.8469
2025-03-24 18:17:03,836 - lenet - INFO -   - Balanced Accuracy: 0.8523
2025-03-24 18:17:03,836 - lenet - INFO -   - Precision: 0.6822
2025-03-24 18:17:03,836 - lenet - INFO -   - Recall: 0.8649
2025-03-24 18:17:03,836 - lenet - INFO -   - Specificity: 0.8398
2025-03-24 18:17:03,836 - lenet - INFO -   - F1 Score: 0.7628
2025-03-24 18:17:03,836 - lenet - INFO -   - AUC: 0.9244
2025-03-24 18:17:03,837 - lenet - INFO -   - Confusion Matrix: 
[[33349  6362]
 [ 2134 13660]]
2025-03-24 18:17:03,837 - lenet - INFO - Saved metrics to /Users/noeflandre/Documents/[03] School/École d'ingénieur/3A/IIT Bombay/Courses/Medical Image Computing/Project/Adversarial-Attacks-on-Medical-Images-Classifiers/models/lenet/results/metrics_20250324_181703.json
2025-03-24 18:17:03,937 - lenet - INFO - Saved confusion matrix plot to /Users/noeflandre/Documents/[03] School/École d'ingénieur/3A/IIT Bombay/Courses/Medical Image Computing/Project/Adversarial-Attacks-on-Medical-Images-Classifiers/models/lenet/results/confusion_matrix_20250324_181703.png
2025-03-24 18:17:03,976 - lenet - INFO - Saved ROC curve plot to /Users/noeflandre/Documents/[03] School/École d'ingénieur/3A/IIT Bombay/Courses/Medical Image Computing/Project/Adversarial-Attacks-on-Medical-Images-Classifiers/models/lenet/results/roc_curve_20250324_181703.png
2025-03-24 18:17:03,978 - lenet - INFO - Training and evaluation completed successfully!
