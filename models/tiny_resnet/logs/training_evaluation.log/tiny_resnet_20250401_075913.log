2025-04-01 07:59:13,982 - INFO - Logging initialized. Log file: /workspace/Adversarial-Attacks-on-Medical-Images-Classifiers/models/tiny_resnet/logs/training_evaluation.log/tiny_resnet_20250401_075913.log
2025-04-01 07:59:13,982 - INFO - Starting TinyResNet classifier training and evaluation
2025-04-01 07:59:13,982 - INFO - Configuration:
2025-04-01 07:59:13,982 - INFO -   - Epochs: 20
2025-04-01 07:59:13,982 - INFO -   - Batch size: 4096
2025-04-01 07:59:13,982 - INFO -   - Learning rate: 0.0001
2025-04-01 07:59:13,982 - INFO -   - Weight decay: 1e-05
2025-04-01 07:59:13,982 - INFO -   - Validation ratio: 0.2
2025-04-01 07:59:13,982 - INFO -   - Number of blocks per layer: 1
2025-04-01 07:59:13,982 - INFO - 
Loading datasets from data/
2025-04-01 07:59:15,223 - INFO - Training set size: 222019
2025-04-01 07:59:15,224 - INFO - Validation set size: 55505
2025-04-01 07:59:15,224 - INFO - 
Initializing TinyResNet model
2025-04-01 07:59:15,241 - INFO - Model parameters: 199,442 (0.20M)
2025-04-01 07:59:15,241 - INFO - Using device: cuda
2025-04-01 07:59:15,241 - INFO - 
Starting model training
2025-04-01 07:59:15,241 - INFO - Using torch.compile for model acceleration
2025-04-01 08:00:25,085 - INFO - Model parameters: 199,442 (0.20M)
2025-04-01 08:00:25,086 - INFO - Training with batch size: 4096, initial learning rate: 0.0001, epochs: 20
2025-04-01 08:00:25,086 - INFO - Class weights: [0.6982520222663879, 1.761021375656128]
2025-04-01 08:00:25,086 - INFO - Early stopping enabled with patience: 5
2025-04-01 08:01:29,314 - INFO - [Epoch 1/20] Train Loss: 0.4472, Val Loss: 0.4063, Val Accuracy: 0.8273
2025-04-01 08:02:15,615 - INFO - [Epoch 2/20] Train Loss: 0.3956, Val Loss: 0.3908, Val Accuracy: 0.8457
2025-04-01 08:02:59,700 - INFO - [Epoch 3/20] Train Loss: 0.3844, Val Loss: 0.3775, Val Accuracy: 0.8303
2025-04-01 08:03:44,014 - INFO - [Epoch 4/20] Train Loss: 0.3834, Val Loss: 0.3728, Val Accuracy: 0.8441
2025-04-01 08:04:28,224 - INFO - [Epoch 5/20] Train Loss: 0.3715, Val Loss: 0.3693, Val Accuracy: 0.8313
2025-04-01 08:05:12,340 - INFO - [Epoch 6/20] Train Loss: 0.3669, Val Loss: 0.3690, Val Accuracy: 0.8229
2025-04-01 08:05:55,899 - INFO - [Epoch 7/20] Train Loss: 0.3637, Val Loss: 0.3570, Val Accuracy: 0.8517
2025-04-01 08:06:40,089 - INFO - [Epoch 8/20] Train Loss: 0.3621, Val Loss: 0.3535, Val Accuracy: 0.8509
2025-04-01 08:07:24,216 - INFO - [Epoch 9/20] Train Loss: 0.3575, Val Loss: 0.3575, Val Accuracy: 0.8317
2025-04-01 08:08:08,466 - INFO - [Epoch 10/20] Train Loss: 0.3544, Val Loss: 0.3765, Val Accuracy: 0.8092
2025-04-01 08:08:52,784 - INFO - [Epoch 11/20] Train Loss: 0.3551, Val Loss: 0.3480, Val Accuracy: 0.8514
2025-04-01 08:09:37,305 - INFO - [Epoch 12/20] Train Loss: 0.3491, Val Loss: 0.3444, Val Accuracy: 0.8579
2025-04-01 08:10:21,527 - INFO - [Epoch 13/20] Train Loss: 0.3459, Val Loss: 0.3437, Val Accuracy: 0.8610
2025-04-01 08:11:05,783 - INFO - [Epoch 14/20] Train Loss: 0.3450, Val Loss: 0.3395, Val Accuracy: 0.8583
2025-04-01 08:11:49,924 - INFO - [Epoch 15/20] Train Loss: 0.3418, Val Loss: 0.3469, Val Accuracy: 0.8649
2025-04-01 08:12:34,417 - INFO - [Epoch 16/20] Train Loss: 0.3408, Val Loss: 0.3400, Val Accuracy: 0.8545
2025-04-01 08:13:18,914 - INFO - [Epoch 17/20] Train Loss: 0.3426, Val Loss: 0.3376, Val Accuracy: 0.8479
2025-04-01 08:14:03,290 - INFO - [Epoch 18/20] Train Loss: 0.3397, Val Loss: 0.3341, Val Accuracy: 0.8547
2025-04-01 08:14:47,293 - INFO - [Epoch 19/20] Train Loss: 0.3385, Val Loss: 0.3344, Val Accuracy: 0.8611
2025-04-01 08:15:31,427 - INFO - [Epoch 20/20] Train Loss: 0.3386, Val Loss: 0.3458, Val Accuracy: 0.8699
2025-04-01 08:15:31,570 - INFO - Saved training and validation loss plot to /workspace/Adversarial-Attacks-on-Medical-Images-Classifiers/models/tiny_resnet/results/training_evaluation/training_validation_loss.png
2025-04-01 08:15:31,571 - INFO - 
Starting model evaluation on validation set
2025-04-01 08:15:31,571 - INFO - Evaluating model with batch size: 4096
2025-04-01 08:15:54,480 - INFO - Evaluation results:
2025-04-01 08:15:54,480 - INFO -   - Accuracy: 0.8699
2025-04-01 08:15:54,480 - INFO -   - Balanced Accuracy: 0.8486
2025-04-01 08:15:54,480 - INFO -   - Precision: 0.7561
2025-04-01 08:15:54,480 - INFO -   - Recall: 0.7994
2025-04-01 08:15:54,480 - INFO -   - Specificity: 0.8978
2025-04-01 08:15:54,480 - INFO -   - F1 Score: 0.7771
2025-04-01 08:15:54,480 - INFO -   - AUC: 0.9323
2025-04-01 08:15:54,481 - INFO -   - Confusion Matrix: 
[[35694  4062]
 [ 3159 12590]]
2025-04-01 08:15:54,481 - INFO - Saved metrics to /workspace/Adversarial-Attacks-on-Medical-Images-Classifiers/models/tiny_resnet/results/training_evaluation/metrics_20250401_081554.json
2025-04-01 08:15:54,665 - INFO - Saved confusion matrix plot to /workspace/Adversarial-Attacks-on-Medical-Images-Classifiers/models/tiny_resnet/results/training_evaluation/confusion_matrix_20250401_081554.png
2025-04-01 08:15:54,767 - INFO - Saved ROC curve plot to /workspace/Adversarial-Attacks-on-Medical-Images-Classifiers/models/tiny_resnet/results/training_evaluation/roc_curve_20250401_081554.png
2025-04-01 08:15:54,773 - INFO - Model and metrics saved to /workspace/Adversarial-Attacks-on-Medical-Images-Classifiers/models/tiny_resnet/checkpoints/tiny_resnet_model_20250401_081554.pth
2025-04-01 08:15:54,773 - INFO - 
Completed training and evaluation
