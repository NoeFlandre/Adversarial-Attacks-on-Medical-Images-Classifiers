2025-03-30 13:48:52,988 - INFO - Logging initialized. Log file: /Users/noeflandre/Documents/[03] School/École d'ingénieur/3A/IIT Bombay/Courses/Medical Image Computing/Project/Adversarial-Attacks-on-Medical-Images-Classifiers/models/mlp/logs/training_evaluation.log/mlp_20250330_134852.log
2025-03-30 13:48:52,988 - INFO - Starting MLP classifier training and evaluation
2025-03-30 13:48:52,988 - INFO - Configuration:
2025-03-30 13:48:52,988 - INFO -   - Epochs: 20
2025-03-30 13:48:52,988 - INFO -   - Batch size: 1024
2025-03-30 13:48:52,988 - INFO -   - Learning rate: 1e-05
2025-03-30 13:48:52,988 - INFO -   - Weight decay: 1e-05
2025-03-30 13:48:52,988 - INFO -   - Validation ratio: 0.2
2025-03-30 13:48:52,988 - INFO -   - Hidden size: 32
2025-03-30 13:48:52,988 - INFO - 
Loading datasets from data/
2025-03-30 13:48:54,868 - INFO - Training set size: 222019
2025-03-30 13:48:54,868 - INFO - Validation set size: 55505
2025-03-30 13:48:54,868 - INFO - 
Initializing MLP model
2025-03-30 13:48:54,880 - INFO - Model parameters: 255,594 (0.26M)
2025-03-30 13:48:54,893 - INFO - Using device: mps
2025-03-30 13:48:54,893 - INFO - 
Starting model training
2025-03-30 13:50:11,411 - INFO - Training with batch size: 1024, initial learning rate: 1e-05, epochs: 20
2025-03-30 13:50:11,413 - INFO - Class weights: [0.6980544328689575, 1.7622793912887573]
2025-03-30 13:51:35,034 - INFO - [Epoch 1/20] Train Loss: 0.5924, Val Loss: 0.5172, Val Accuracy: 0.7760
2025-03-30 13:52:55,451 - INFO - [Epoch 2/20] Train Loss: 0.4935, Val Loss: 0.4844, Val Accuracy: 0.7981
2025-03-30 13:54:21,150 - INFO - [Epoch 3/20] Train Loss: 0.4802, Val Loss: 0.4783, Val Accuracy: 0.8034
2025-03-30 13:55:45,178 - INFO - Reducing learning rate to 8.00e-06
2025-03-30 13:55:45,178 - INFO - [Epoch 4/20] Train Loss: 0.4749, Val Loss: 0.4740, Val Accuracy: 0.8061
2025-03-30 13:57:09,283 - INFO - Reducing learning rate to 6.40e-06
2025-03-30 13:57:09,283 - INFO - [Epoch 5/20] Train Loss: 0.4710, Val Loss: 0.4711, Val Accuracy: 0.8065
2025-03-30 13:58:28,959 - INFO - Reducing learning rate to 5.12e-06
2025-03-30 13:58:28,960 - INFO - [Epoch 6/20] Train Loss: 0.4679, Val Loss: 0.4686, Val Accuracy: 0.8075
2025-03-30 13:59:50,721 - INFO - Reducing learning rate to 4.10e-06
2025-03-30 13:59:50,721 - INFO - [Epoch 7/20] Train Loss: 0.4654, Val Loss: 0.4668, Val Accuracy: 0.8093
2025-03-30 14:01:13,954 - INFO - Reducing learning rate to 3.28e-06
2025-03-30 14:01:13,955 - INFO - [Epoch 8/20] Train Loss: 0.4637, Val Loss: 0.4655, Val Accuracy: 0.8094
2025-03-30 14:02:40,085 - INFO - Reducing learning rate to 2.62e-06
2025-03-30 14:02:40,085 - INFO - [Epoch 9/20] Train Loss: 0.4623, Val Loss: 0.4645, Val Accuracy: 0.8104
2025-03-30 14:04:02,404 - INFO - Reducing learning rate to 2.10e-06
2025-03-30 14:04:02,405 - INFO - [Epoch 10/20] Train Loss: 0.4613, Val Loss: 0.4638, Val Accuracy: 0.8106
2025-03-30 14:05:28,709 - INFO - Reducing learning rate to 1.68e-06
2025-03-30 14:05:28,715 - INFO - [Epoch 11/20] Train Loss: 0.4605, Val Loss: 0.4633, Val Accuracy: 0.8110
2025-03-30 14:06:49,079 - INFO - Reducing learning rate to 1.34e-06
2025-03-30 14:06:49,079 - INFO - [Epoch 12/20] Train Loss: 0.4598, Val Loss: 0.4628, Val Accuracy: 0.8111
2025-03-30 14:08:13,331 - INFO - Reducing learning rate to 1.07e-06
2025-03-30 14:08:13,331 - INFO - [Epoch 13/20] Train Loss: 0.4594, Val Loss: 0.4624, Val Accuracy: 0.8112
2025-03-30 14:09:39,636 - INFO - Reducing learning rate to 8.59e-07
2025-03-30 14:09:39,636 - INFO - [Epoch 14/20] Train Loss: 0.4590, Val Loss: 0.4621, Val Accuracy: 0.8114
2025-03-30 14:11:00,325 - INFO - Reducing learning rate to 6.87e-07
2025-03-30 14:11:00,325 - INFO - [Epoch 15/20] Train Loss: 0.4587, Val Loss: 0.4619, Val Accuracy: 0.8118
2025-03-30 14:12:25,046 - INFO - Reducing learning rate to 5.50e-07
2025-03-30 14:12:25,047 - INFO - [Epoch 16/20] Train Loss: 0.4584, Val Loss: 0.4617, Val Accuracy: 0.8117
2025-03-30 14:13:44,882 - INFO - Reducing learning rate to 4.40e-07
2025-03-30 14:13:44,882 - INFO - [Epoch 17/20] Train Loss: 0.4583, Val Loss: 0.4615, Val Accuracy: 0.8121
2025-03-30 14:15:04,892 - INFO - Reducing learning rate to 3.52e-07
2025-03-30 14:15:04,893 - INFO - [Epoch 18/20] Train Loss: 0.4581, Val Loss: 0.4614, Val Accuracy: 0.8121
2025-03-30 14:16:26,471 - INFO - Reducing learning rate to 2.81e-07
2025-03-30 14:16:26,473 - INFO - [Epoch 19/20] Train Loss: 0.4580, Val Loss: 0.4613, Val Accuracy: 0.8120
2025-03-30 14:17:53,916 - INFO - Reducing learning rate to 2.25e-07
2025-03-30 14:17:53,916 - INFO - [Epoch 20/20] Train Loss: 0.4578, Val Loss: 0.4612, Val Accuracy: 0.8121
2025-03-30 14:17:54,444 - INFO - Saved training and validation loss plot to /Users/noeflandre/Documents/[03] School/École d'ingénieur/3A/IIT Bombay/Courses/Medical Image Computing/Project/Adversarial-Attacks-on-Medical-Images-Classifiers/models/mlp/results/training_evaluation/training_validation_loss.png
2025-03-30 14:17:54,446 - INFO - 
Starting model evaluation on validation set
2025-03-30 14:17:54,448 - INFO - Evaluating model with batch size: 1024
2025-03-30 14:18:14,186 - INFO - Evaluation results:
2025-03-30 14:18:14,187 - INFO -   - Accuracy: 0.8121
2025-03-30 14:18:14,187 - INFO -   - Balanced Accuracy: 0.7955
2025-03-30 14:18:14,187 - INFO -   - Precision: 0.6447
2025-03-30 14:18:14,187 - INFO -   - Recall: 0.7569
2025-03-30 14:18:14,187 - INFO -   - Specificity: 0.8341
2025-03-30 14:18:14,187 - INFO -   - F1 Score: 0.6963
2025-03-30 14:18:14,187 - INFO -   - AUC: 0.8686
2025-03-30 14:18:14,187 - INFO -   - Confusion Matrix: 
[[33123  6588]
 [ 3839 11955]]
2025-03-30 14:18:14,188 - INFO - Saved metrics to /Users/noeflandre/Documents/[03] School/École d'ingénieur/3A/IIT Bombay/Courses/Medical Image Computing/Project/Adversarial-Attacks-on-Medical-Images-Classifiers/models/mlp/results/training_evaluation/metrics_20250330_141814.json
2025-03-30 14:18:14,257 - INFO - Saved confusion matrix plot to /Users/noeflandre/Documents/[03] School/École d'ingénieur/3A/IIT Bombay/Courses/Medical Image Computing/Project/Adversarial-Attacks-on-Medical-Images-Classifiers/models/mlp/results/training_evaluation/confusion_matrix_20250330_141814.png
2025-03-30 14:18:14,295 - INFO - Saved ROC curve plot to /Users/noeflandre/Documents/[03] School/École d'ingénieur/3A/IIT Bombay/Courses/Medical Image Computing/Project/Adversarial-Attacks-on-Medical-Images-Classifiers/models/mlp/results/training_evaluation/roc_curve_20250330_141814.png
2025-03-30 14:18:14,303 - INFO - Model and metrics saved to /Users/noeflandre/Documents/[03] School/École d'ingénieur/3A/IIT Bombay/Courses/Medical Image Computing/Project/Adversarial-Attacks-on-Medical-Images-Classifiers/models/mlp/checkpoints/mlp_model_20250330_141814.pth
2025-03-30 14:18:14,303 - INFO - 
Completed training and evaluation
