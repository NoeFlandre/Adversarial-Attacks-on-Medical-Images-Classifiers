2025-03-30 14:21:13,418 - INFO - Logging initialized. Log file: /Users/noeflandre/Documents/[03] School/École d'ingénieur/3A/IIT Bombay/Courses/Medical Image Computing/Project/Adversarial-Attacks-on-Medical-Images-Classifiers/models/mlp/logs/adversarial_training.log/mlp_20250330_142113.log
2025-03-30 14:21:13,418 - INFO - Starting MLP classifier with adversarial training
2025-03-30 14:21:13,418 - INFO - Configuration:
2025-03-30 14:21:13,418 - INFO -   - Epochs: 20
2025-03-30 14:21:13,418 - INFO -   - Batch size: 1024
2025-03-30 14:21:13,418 - INFO -   - Learning rate: 1e-05
2025-03-30 14:21:13,418 - INFO -   - Weight decay: 1e-05
2025-03-30 14:21:13,418 - INFO -   - Validation ratio: 0.2
2025-03-30 14:21:13,418 - INFO -   - FGSM epsilon: 0.05
2025-03-30 14:21:13,418 - INFO -   - Mix ratio: 0.5
2025-03-30 14:21:13,418 - INFO -   - Hidden size: 32
2025-03-30 14:21:13,418 - INFO - 
Loading datasets from data/
2025-03-30 14:21:15,396 - INFO - Training set size: 222019
2025-03-30 14:21:15,396 - INFO - Validation set size: 55505
2025-03-30 14:21:15,396 - INFO - 
Initializing MLP model
2025-03-30 14:21:15,410 - INFO - Model parameters: 255,594 (0.26M)
2025-03-30 14:21:15,430 - INFO - Using device: mps
2025-03-30 14:21:15,436 - INFO - 
Starting model training with adversarial examples
2025-03-30 14:22:42,140 - INFO - Training with adversarial examples (FGSM, epsilon=0.05, mix_ratio=0.5)
2025-03-30 14:22:42,141 - INFO - Batch size: 1024, initial learning rate: 1e-05, epochs: 20
2025-03-30 14:22:42,141 - INFO - Class weights: [0.6980544328689575, 1.7622793912887573]
2025-03-30 14:24:29,444 - INFO - [Epoch 1/20] Train Loss: 0.7436, Clean Val Acc: 0.7690, Adv Val Acc: 0.5741
2025-03-30 14:26:14,685 - INFO - [Epoch 2/20] Train Loss: 0.7651, Clean Val Acc: 0.7863, Adv Val Acc: 0.6644
2025-03-30 14:27:58,093 - INFO - [Epoch 3/20] Train Loss: 0.6763, Clean Val Acc: 0.7886, Adv Val Acc: 0.6699
2025-03-30 14:29:42,634 - INFO - Reducing learning rate to 8.00e-06
2025-03-30 14:29:42,635 - INFO - [Epoch 4/20] Train Loss: 0.6374, Clean Val Acc: 0.7888, Adv Val Acc: 0.6751
2025-03-30 14:31:30,941 - INFO - Reducing learning rate to 6.40e-06
2025-03-30 14:31:30,942 - INFO - [Epoch 5/20] Train Loss: 0.6160, Clean Val Acc: 0.7908, Adv Val Acc: 0.6751
2025-03-30 14:33:25,382 - INFO - Reducing learning rate to 5.12e-06
2025-03-30 14:33:25,383 - INFO - [Epoch 6/20] Train Loss: 0.6045, Clean Val Acc: 0.7897, Adv Val Acc: 0.6629
2025-03-30 14:35:11,012 - INFO - Reducing learning rate to 4.10e-06
2025-03-30 14:35:11,013 - INFO - [Epoch 7/20] Train Loss: 0.5964, Clean Val Acc: 0.7902, Adv Val Acc: 0.6615
2025-03-30 14:36:56,582 - INFO - Reducing learning rate to 3.28e-06
2025-03-30 14:36:56,582 - INFO - [Epoch 8/20] Train Loss: 0.5908, Clean Val Acc: 0.7901, Adv Val Acc: 0.6600
2025-03-30 14:38:47,547 - INFO - Reducing learning rate to 2.62e-06
2025-03-30 14:38:47,547 - INFO - [Epoch 9/20] Train Loss: 0.5864, Clean Val Acc: 0.7904, Adv Val Acc: 0.6586
2025-03-30 14:40:32,099 - INFO - Reducing learning rate to 2.10e-06
2025-03-30 14:40:32,099 - INFO - [Epoch 10/20] Train Loss: 0.5851, Clean Val Acc: 0.7903, Adv Val Acc: 0.6577
2025-03-30 14:42:18,750 - INFO - Reducing learning rate to 1.68e-06
2025-03-30 14:42:18,751 - INFO - [Epoch 11/20] Train Loss: 0.5836, Clean Val Acc: 0.7914, Adv Val Acc: 0.6589
2025-03-30 14:44:08,958 - INFO - Reducing learning rate to 1.34e-06
2025-03-30 14:44:08,959 - INFO - [Epoch 12/20] Train Loss: 0.5836, Clean Val Acc: 0.7918, Adv Val Acc: 0.6578
2025-03-30 14:45:52,822 - INFO - Reducing learning rate to 1.07e-06
2025-03-30 14:45:52,822 - INFO - [Epoch 13/20] Train Loss: 0.5825, Clean Val Acc: 0.7919, Adv Val Acc: 0.6578
2025-03-30 14:47:37,453 - INFO - Reducing learning rate to 8.59e-07
2025-03-30 14:47:37,454 - INFO - [Epoch 14/20] Train Loss: 0.5821, Clean Val Acc: 0.7918, Adv Val Acc: 0.6568
2025-03-30 14:49:20,933 - INFO - Reducing learning rate to 6.87e-07
2025-03-30 14:49:20,934 - INFO - [Epoch 15/20] Train Loss: 0.5813, Clean Val Acc: 0.7922, Adv Val Acc: 0.6569
2025-03-30 14:51:06,971 - INFO - Reducing learning rate to 5.50e-07
2025-03-30 14:51:06,972 - INFO - [Epoch 16/20] Train Loss: 0.5816, Clean Val Acc: 0.7921, Adv Val Acc: 0.6562
2025-03-30 14:52:51,490 - INFO - Reducing learning rate to 4.40e-07
2025-03-30 14:52:51,491 - INFO - [Epoch 17/20] Train Loss: 0.5810, Clean Val Acc: 0.7923, Adv Val Acc: 0.6560
2025-03-30 14:54:36,813 - INFO - Reducing learning rate to 3.52e-07
2025-03-30 14:54:36,814 - INFO - [Epoch 18/20] Train Loss: 0.5811, Clean Val Acc: 0.7922, Adv Val Acc: 0.6561
2025-03-30 14:56:21,844 - INFO - Reducing learning rate to 2.81e-07
2025-03-30 14:56:21,847 - INFO - [Epoch 19/20] Train Loss: 0.5814, Clean Val Acc: 0.7923, Adv Val Acc: 0.6566
2025-03-30 14:58:04,692 - INFO - Reducing learning rate to 2.25e-07
2025-03-30 14:58:04,692 - INFO - [Epoch 20/20] Train Loss: 0.5808, Clean Val Acc: 0.7923, Adv Val Acc: 0.6566
2025-03-30 14:58:05,109 - INFO - Saved training plots to /Users/noeflandre/Documents/[03] School/École d'ingénieur/3A/IIT Bombay/Courses/Medical Image Computing/Project/Adversarial-Attacks-on-Medical-Images-Classifiers/models/mlp/results/adversarial_training/training_validation_loss_eps0.05_mix0.5_20250330_145804.png and /Users/noeflandre/Documents/[03] School/École d'ingénieur/3A/IIT Bombay/Courses/Medical Image Computing/Project/Adversarial-Attacks-on-Medical-Images-Classifiers/models/mlp/results/adversarial_training/clean_vs_adversarial_accuracy_eps0.05_mix0.5_20250330_145804.png
2025-03-30 14:58:05,109 - INFO - Saved training history to /Users/noeflandre/Documents/[03] School/École d'ingénieur/3A/IIT Bombay/Courses/Medical Image Computing/Project/Adversarial-Attacks-on-Medical-Images-Classifiers/models/mlp/results/adversarial_training/training_history_eps0.05_mix0.5_20250330_145804.json
2025-03-30 14:58:05,110 - INFO - 
Starting model evaluation on validation set
2025-03-30 14:58:05,110 - INFO - Evaluating model with batch size: 1024
2025-03-30 14:58:22,814 - INFO - Evaluation results:
2025-03-30 14:58:22,814 - INFO -   - Accuracy: 0.7923
2025-03-30 14:58:22,814 - INFO -   - Balanced Accuracy: 0.7836
2025-03-30 14:58:22,814 - INFO -   - Precision: 0.6074
2025-03-30 14:58:22,814 - INFO -   - Recall: 0.7635
2025-03-30 14:58:22,814 - INFO -   - Specificity: 0.8037
2025-03-30 14:58:22,814 - INFO -   - F1 Score: 0.6765
2025-03-30 14:58:22,814 - INFO -   - AUC: 0.8544
2025-03-30 14:58:22,814 - INFO -   - Confusion Matrix: 
[[31916  7795]
 [ 3736 12058]]
2025-03-30 14:58:22,815 - INFO - Saving results to adversarial training directory
2025-03-30 14:58:22,815 - INFO - Saved metrics to /Users/noeflandre/Documents/[03] School/École d'ingénieur/3A/IIT Bombay/Courses/Medical Image Computing/Project/Adversarial-Attacks-on-Medical-Images-Classifiers/models/mlp/results/adversarial_training/metrics_20250330_145822.json
2025-03-30 14:58:22,887 - INFO - Saved confusion matrix plot to /Users/noeflandre/Documents/[03] School/École d'ingénieur/3A/IIT Bombay/Courses/Medical Image Computing/Project/Adversarial-Attacks-on-Medical-Images-Classifiers/models/mlp/results/adversarial_training/confusion_matrix_20250330_145822.png
2025-03-30 14:58:22,926 - INFO - Saved ROC curve plot to /Users/noeflandre/Documents/[03] School/École d'ingénieur/3A/IIT Bombay/Courses/Medical Image Computing/Project/Adversarial-Attacks-on-Medical-Images-Classifiers/models/mlp/results/adversarial_training/roc_curve_20250330_145822.png
2025-03-30 14:58:22,935 - INFO - Model and metrics saved to /Users/noeflandre/Documents/[03] School/École d'ingénieur/3A/IIT Bombay/Courses/Medical Image Computing/Project/Adversarial-Attacks-on-Medical-Images-Classifiers/models/mlp/checkpoints/mlp_adversarial_eps0.05_mix0.5_20250330_145822.pth
2025-03-30 14:58:22,935 - INFO - Results summary saved to /Users/noeflandre/Documents/[03] School/École d'ingénieur/3A/IIT Bombay/Courses/Medical Image Computing/Project/Adversarial-Attacks-on-Medical-Images-Classifiers/models/mlp/results/adversarial_training/adversarial_training_summary_eps0.05_mix0.5_20250330_145822.json
2025-03-30 14:58:22,936 - INFO - 
Completed adversarial training and evaluation
